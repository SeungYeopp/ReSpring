# 테이블 기본키 설계: UUID vs 정수형

테이블 기본키로 사용할 ID를 **UUID**로 할지 **정수형**으로 할지 비교 분석한 내용입니다. 각각의 방식은 프로젝트 요구사항에 따라 적합성이 달라집니다.

---

## 1. UUID

### 장점

- **전역 고유성 보장**:
    
    전 세계적으로 고유하므로 분산 시스템이나 여러 데이터베이스에서 충돌을 방지.
    
    예: 마이크로서비스 구조에서 데이터베이스 간 동기화에 유리.
    
- **데이터 추적 어려움**:
    
    예측하거나 추측하기 어렵기 때문에 민감 데이터 보호에 유리.
    
- **중앙 관리 불필요**:
    
    애플리케이션에서 ID 생성 가능.
    
- **확장성**:
    
    테이블 병합, 데이터 복제 시 충돌 위험이 적음.
    

### 단점

- **크기**:
    
    128비트로 정수형(4~8바이트)보다 저장 공간을 더 많이 차지하며, 인덱스 크기 증가로 성능 저하 가능.
    
- **가독성 부족**:
    
    사람이 읽고 관리하기 어려움.
    
    예: `550e8400-e29b-41d4-a716-446655440000`.
    
- **성능**:
    
    랜덤하게 생성된 UUID는 B-Tree 인덱스의 조각화를 초래해 삽입/검색 성능 저하 가능.
    

---

## 2. 정수형 (Auto-Increment)

### 장점

- **간단하고 효율적**:
    
    작은 크기와 효율적인 계산 및 정렬.
    
- **가독성**:
    
    디버깅과 로그 추적에 유리.
    
    예: `1`, `2`, `3`.
    
- **저장 공간 효율**:
    
    4바이트 또는 8바이트로 UUID보다 공간 절약.
    
- **관계형 데이터베이스 최적화**:
    
    대부분의 RDBMS가 정수형 PK에 최적화.
    

### 단점

- **전역 고유성 부족**:
    
    분산 시스템에서 동기화 시 충돌 가능.
    
- **예측 가능성**:
    
    ID를 순서대로 생성하므로 외부 공격자가 쉽게 추측 가능.
    
- **확장성 한계**:
    
    여러 데이터베이스가 동시에 PK를 생성하는 구조에서 문제 발생 가능.
    

---

## 3. 사용 사례별 선택 가이드

| 요구사항 | 추천 방식 | 이유 |
| --- | --- | --- |
| 분산 시스템/마이크로서비스 | UUID | 글로벌 고유성 및 충돌 방지 |
| 단일 데이터베이스/중소규모 | 정수형 | 성능 최적화 및 간단한 관리 |
| 보안 민감 데이터 | UUID | 예측 가능성이 낮아 데이터 보호 강화 |
| 고성능 읽기/쓰기 | 정수형 | 작은 크기와 정렬 효율로 성능 최적화 가능 |
| 대규모 데이터 마이그레이션 | UUID | 데이터 병합 시 충돌 방지 |

### 혼합 사용 가능성

- 주요 테이블에 UUID를 사용하고, 관계 테이블(예: Many-to-Many)에 정수형 사용 가능.

---

## 4. UUID 사용 시 JPA 설정 및 문제 해결

### 주요 문제

1. **UUID 자동 생성 문제**:
    - `GenerationType.IDENTITY`나 `GenerationType.SEQUENCE`는 정수형을 대상으로 설계되어 동작하지 않을 수 있음.
2. **키 중복 방지 문제**:
    - 애플리케이션에서 UUID 생성 시 중복 발생 가능성 존재.
3. **삽입 성능 문제**:
    - 랜덤하게 생성된 UUID는 클러스터링된 인덱스(B-Tree)의 성능 저하를 유발.

### 해결 방법

1. **UUID 자동 생성 설정**
    - `@GenericGenerator` 사용: